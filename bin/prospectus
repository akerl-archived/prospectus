#!/usr/bin/env ruby

require 'prospectus'
require 'mercenary'

Mercenary.program(:prospectus) do |p|
  p.version Prospectus::VERSION
  p.description 'Tool and DSL for checking expected vs actual state'
  p.syntax 'prospectus [options]'

  p.option :directory, '-d', '--directory', 'Change to directory before loading'

  p.action do |_, options|
    options[:directory] ||= '.'
    Dir.chdir(options[:directory]) do
      Prospectus.load_from_file(options).check.each do |x|
        puts "#{x.name}: #{x.actual} / #{x.expected}"
      end
    end
  end
end
